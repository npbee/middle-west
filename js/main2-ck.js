var mwm=function(e,t,n){var r=e(t).width(),s=e(" #mobile__menu__button "),o=e(" nav ul "),u=e(" .sub-nav ul a"),a=function(){return r>=768?!0:!1},f=function(t,n){var r=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;if(t==""){e(".error--invalid").fadeOut(300);e(".error--empty").fadeIn(300);e("input#email").focus();return!1}if(!r.test(t)){e(".error--empty").fadeOut(100);e(".error--invalid").fadeIn(300);e("input#email").focus();return!1}var i=e(".mailing-list form").serialize();e.ajax({type:"POST",url:"../../php/mailing-list-submit.php",data:i,success:function(){var t="<div class='thanks'>Thanks!</div>";e(".error").hide();e(t).hide().appendTo("footer").fadeIn(300).delay(1e3).fadeOut(300);e(".mailing-list form").each(function(){this.reset()})},error:function(){e("footer").append("<div class='submit-error error'>There was an error processing this</div>")}});return!1},l={init:function(e,t){var n,r;if(t=="home"){n=5;r="<a class='load-more-posts'>Load More Posts</a>"}else{n=2;r="<a class='load-more-posts' target='_blank' href='http://middlewestmgmt.tumblr.com/tagged/"+e+"'>Read More Posts</a>"}this.getPosts(n,e,r)},getPosts:function(t,n,r){e.ajax({type:"GET",dataType:"jsonp",url:"http://api.tumblr.com/v2/blog/middlewestmgmt.tumblr.com/posts?api_key=5cHAhSpCdCiLOdeoWeJAAwCbqFUW4LCvfe9GxwVJXWcgUH4XSl&tag="+n,data:{get_param:"value"},success:function(n){for(i=0;i<t;i++){var s=n.response.posts[i].date,o=s.split("-"),u=o[2].split(" "),a=o[0],f=o[1],l=u[0];e(".news .news-feed").append("<article><h3 class='post-title'>"+n.response.posts[i].title+"</h3>"+"<div class='post-date'>"+f+"/"+l+"/"+a+"</div>"+"<div>"+n.response.posts[i].body+"</div>"+"<div class='post-meta'>tags: "+"<span><a target='_blank' href='http://tumblr.com/tagged/"+n.response.posts[i].tags+"''>"+n.response.posts[i].tags+"</span>"+"<span><a href="+n.response.posts[i].post_url+" target='_blank'>permalink</a></span>"+"</div>"+"</article>");e(".news").fitVids()}e(".news .news-feed").append(r)}})}};return{init:function(){console.log(isMobile())},colorbox:function(){if(a()){e(" .colorbox ").colorbox({rel:"group"});e(" .colorbox-iframe ").colorbox({iframe:!0,width:"80%",height:"80%",rel:"group-videos",transition:"none",reposition:!1})}},mobileAlbum:function(){if(!a()){e(" .thumb-container ").on("click",function(t){var n=e(this).next();e(n).toggleClass("show");t.preventDefault()});e(" .mobile-album-info-close ").on("click",function(){e(" .mobile-album-info ").removeClass("show")})}},expander:function(){e(" .expandable ").expander({expandText:"more",userCollapseText:"less",expandSpeed:400,collapseSpeed:400,moreClass:"read-more",lessClass:"read-less",slicePoint:800})},flexslider:function(){e(" .flexslider ").flexslider({animation:"slide",useCSS:!0});e(" .flexslider-mini ").flexslider({animation:"slide",slideshow:!1,useCSS:!0})},lazyload:function(){e(" img.lazy ").unveil(500)},mobileNav:function(){s.on("click",function(e){o.toggleClass("mobile__menu--open");e.preventDefault()});u.on("click",function(){var n=e(this).attr("href");o.removeClass("mobile__menu--open");e("html, body").stop().animate({scrollTop:e(n).offset().top},400,"swing",function(){t.location.hash=n})})},mailingList:function(){var t=e("input#email").val(),n=e("#oid").val();e(" #submit ").on("click",function(t){t.preventDefault();var n=e("input#email").val(),r=e("#oid").val();f(n,r)})},scrollable:function(){e(" .news .scrollable ").scroll(function(){var t=e(this),n=e(this).scrollTop();n>=1?e(this).parent().addClass("bordered").addClass("no-fade"):e(this).parent().removeClass("bordered")})},soundcloud:function(){a()&&e.stratus({links:"https://soundcloud.com/middlewestmgmt/sets/middlewestmgmt-com"})},tumblr:function(){var t=mwmTumblr.tag,n=e(" body ").attr("class");l.init(t,n)}}}(window.jQuery,window,document);$(function(){mwm.colorbox();mwm.mobileAlbum();mwm.expander();mwm.flexslider();mwm.lazyload();mwm.mobileNav();mwm.mailingList();mwm.scrollable();mwm.soundcloud();mwm.tumblr()});