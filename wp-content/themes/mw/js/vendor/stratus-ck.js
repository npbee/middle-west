(function(){var e;e=jQuery;(function(e){var t,n,r=1,i,s=this,o=!1,u="postMessage",a="addEventListener",f,l=s[u]&&!e.browser.opera;e[u]=function(t,n,i){if(!n)return;t=typeof t=="string"?t:e.param(t);i=i||parent;l?i[u](t,n.replace(/([^:]+:\/\/[^\/]+).*/,"$1")):n&&(i.location=n.replace(/#.*$/,"")+"#"+ +(new Date)+r++ +"&"+t)};e.receiveMessage=f=function(r,u,h){if(l){if(r){i&&f();i=function(t){if(typeof u=="string"&&t.origin!==u||e.isFunction(u)&&u(t.origin)===o)return o;r(t)}}s[a]?s[r?a:"removeEventListener"]("message",i,o):s[r?"attachEvent":"detachEvent"]("onmessage",i)}else{t&&clearInterval(t);t=null;if(r){h=typeof u=="number"?u:typeof h=="number"?h:100;t=setInterval(function(){var e=document.location.hash,t=/^#?\d+&/;if(e!==n&&t.test(e)){n=e;r({data:e.replace(t,"")})}},h)}}}})(jQuery);e.fn.stratus=function(t){return e.stratus(t)};e.stratus=function(t){var n,r;n=t.env==="development"?"http://example.com:3000":"http://stratus.sc";e("head").append("<link rel='stylesheet' href='"+n+"/stratus.css' type='text/css'/>");t.align==="top"&&e("head").append("<style>#stratus{ top: 0; }</style>");t.position==="absolute"&&e("head").append("<style>#stratus{ position: absolute; }</style>");t.offset&&e("head").append("<style>#stratus{ "+t.align+": "+t.offset+"px !important; }</style>");e("body").append("<div id='stratus'><iframe allowtransparency='true' frameborder='0' scrolling='0'></div>");r=n+"/player?"+e.param(t,!0)+"&link="+encodeURIComponent(document.location.href);e("#stratus iframe").attr({src:r});e("#stratus iframe").load(function(){return e(this).css({visibility:"visible"})});e("#stratus").show();e("a.stratus").click(function(){e.postMessage(e(this).attr("href"),r,e("#stratus iframe")[0].contentWindow);return!1});return e.receiveMessage(function(t){return e("#stratus").toggleClass("open")},n)}}).call(this);